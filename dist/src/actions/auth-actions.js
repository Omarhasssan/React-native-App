Object.defineProperty(exports,"__esModule",{value:true});exports.checkIfWeKnowThisUserBefore=exports.clearError=exports.Login=exports.Register=undefined;var _this=this;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _helpers=require('../helpers');var _reactNative=require('react-native');var Register=exports.Register=function Register(user){return function(dispatch){dispatch({type:'SIGNUP_REQUEST'});var userObj=_extends({},user,{records:{gamesPlayed:0,goals:0}});return _helpers.DBHelpers.saveUser(userObj).then(function(returnedUser){dispatch({type:'SIGNUP_SUCCESS',returnedUser:returnedUser});_reactNative.AsyncStorage.setItem('@UserId',returnedUser.id).then(function(){return console.log('user saved');});}).catch(function(err){dispatch({type:'SIGNUP_FAILURE',err:err});});};};var Login=exports.Login=function Login(user){return function(dispatch){dispatch({type:'LOGIN_REQUEST'});return _helpers.DBHelpers.checkUserFound(user).then(function(user){dispatch({type:'CREATE_ROOM_BY_USER_ID',id:user.id});dispatch({type:'LOGIN_SUCCESS',user:user});_reactNative.AsyncStorage.setItem('@UserId',user.id).then(function(){return console.log('user saved');});}).catch(function(){dispatch({type:'LOGIN_FAILURE',err:'username or password incorret'});});};};var clearError=exports.clearError=function clearError(){return function(dispatch){dispatch({type:'CLEAR_ERROR'});};};var checkIfWeKnowThisUserBefore=exports.checkIfWeKnowThisUserBefore=function checkIfWeKnowThisUserBefore(){return function(dispatch){_reactNative.AsyncStorage.getItem('@UserId').then(function(userId){if(userId!=null){_helpers.DBHelpers.getUserById(userId).then(function _callee(user){var team,room;return regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:'CREATE_ROOM_BY_USER_ID',id:user.id});if(!user.teamId){_context.next=7;break;}_context.next=4;return regeneratorRuntime.awrap(_helpers.DBHelpers.getTeamById(user.teamId));case 4:team=_context.sent;dispatch({type:'CREATE_ROOM_BY_TEAM_ID',id:user.teamId});dispatch({type:'SET_CURNT_TEAM',team:team});case 7:if(!user.roomId){_context.next=13;break;}_context.next=10;return regeneratorRuntime.awrap(_helpers.DBHelpers.getRoomById(user.roomId));case 10:room=_context.sent;dispatch({type:'CREATE_ROOM_BY_ROOM_ID',id:user.roomId});dispatch({type:'SET_CREATED_ROOM',room:room});case 13:dispatch({type:'LOGIN_SUCCESS',user:user});case 14:case'end':return _context.stop();}}},null,_this);});}});};};