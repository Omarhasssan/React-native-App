Object.defineProperty(exports,"__esModule",{value:true});var _jsxFileName='src/hocs/withSearchContainer.js';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=require('react');var _react2=_interopRequireDefault(_react);var _Search=require('../components/Search');var _Search2=_interopRequireDefault(_Search);var _SearchResults=require('../containers/SearchResults');var _SearchResults2=_interopRequireDefault(_SearchResults);var _SelectedData=require('../containers/SelectedData');var _SelectedData2=_interopRequireDefault(_SelectedData);var _Spinner=require('../components/Spinner');var _Spinner2=_interopRequireDefault(_Spinner);var _reactNativeElements=require('react-native-elements');var _reactNative=require('react-native');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _=require('lodash');exports.default=withSearchContainer=function withSearchContainer(dispatchGetData,data,renderHeaderRight,setCheckedItems,loadCheckedItems,settings){return function(_Component){_inherits(_class2,_Component);function _class2(){var _ref;var _temp,_this,_ret;_classCallCheck(this,_class2);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=_class2.__proto__||Object.getPrototypeOf(_class2)).call.apply(_ref,[this].concat(args))),_this),_this.state={data:'',text:'',loading:false},_temp),_possibleConstructorReturn(_this,_ret);}_createClass(_class2,[{key:'componentDidMount',value:function componentDidMount(){var _props=this.props,navigation=_props.navigation,clearCheckedItems=_props.clearCheckedItems;console.log('did id didid i');loadCheckedItems(this.props);this.setState({loading:true});dispatchGetData(this.props);}},{key:'componentWillReceiveProps',value:function componentWillReceiveProps(nextProps){console.log('withSearchContainer RCCCC',nextProps.checkedItems.loaded);if(!nextProps.checkedItems.loaded&&(Object.keys(nextProps.checkedItems.items).length!==Object.keys(this.props.checkedItems.items).length||!this.isEqual(nextProps.checkedItems.items,this.props.checkedItems.items))){console.log('withSearchContainer innnnn');this.updateCheckedItems(nextProps.checkedItems.items);setCheckedItems(nextProps.checkedItems.items,this.props);}if(data(nextProps).length>0){this.setState({data:data(nextProps)});this.setState({loading:false});}}},{key:'isEqual',value:function isEqual(arr1,arr2){for(var k1 in arr1){var fnd=false;for(var k2 in arr2){if(k1==k2)fnd=true;}if(!fnd)return false;}return true;}},{key:'updateCheckedItems',value:function updateCheckedItems(checkedItems){var navigation=this.props.navigation;if(navigation)navigation.setParams({checkedItems:Object.keys(checkedItems),prps:this.props});}},{key:'componentWillUnmount',value:function componentWillUnmount(){console.log('uuunnnnnnmounttt');}},{key:'render',value:function render(){var _this2=this;var _state=this.state,data=_state.data,text=_state.text,loading=_state.loading;var _props2=this.props,checkedItems=_props2.checkedItems,addCheckedItem=_props2.addCheckedItem,removeCheckedItem=_props2.removeCheckedItem,clearCheckedItems=_props2.clearCheckedItems;if(loading)return _react2.default.createElement(_Spinner2.default,{__source:{fileName:_jsxFileName,lineNumber:90}});this.selectedData=[];this.filteredData=[];if(text.length){this.filteredData=data.filter(function(d){return d.name.includes(text);});}else this.filteredData=data;if(data)for(var k in checkedItems.items){this.selectedData.push(data.filter(function(d){return d.id==k;})[0]);}return _react2.default.createElement(_reactNative.View,{style:{flex:1},__source:{fileName:_jsxFileName,lineNumber:99}},_react2.default.createElement(_Search2.default,{onChangeText:function onChangeText(text){return _this2.setState({text:text});},__source:{fileName:_jsxFileName,lineNumber:100}}),_react2.default.createElement(_SelectedData2.default,{selectedData:this.selectedData,onRemove:function onRemove(key){return removeCheckedItem(key);},checkedItems:checkedItems.items,__source:{fileName:_jsxFileName,lineNumber:101}}),_react2.default.createElement(_reactNative.View,{style:{height:100+'%'},__source:{fileName:_jsxFileName,lineNumber:106}},_react2.default.createElement(_SearchResults2.default,{onCheck:function onCheck(key,value){if(!value)removeCheckedItem(key);else if(settings.singleCheck){clearCheckedItems();addCheckedItem(key);}else addCheckedItem(key);},checkedItems:checkedItems.items,data:this.filteredData,__source:{fileName:_jsxFileName,lineNumber:107}})));}}],[{key:'navigationOptions',value:function navigationOptions(_ref2){var navigation=_ref2.navigation;if(navigation.state.params){return{headerRight:renderHeaderRight(navigation.state.params.checkedItems,navigation,navigation.state.params.prps)};}}}]);return _class2;}(_react.Component);};