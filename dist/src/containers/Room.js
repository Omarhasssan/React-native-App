Object.defineProperty(exports,"__esModule",{value:true});var _jsxFileName='src/containers/Room.js';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=require('react');var _react2=_interopRequireDefault(_react);var _reactRedux=require('react-redux');var _reactNative=require('react-native');var _actions=require('../actions');var _Observer=require('../components/Observer');var _Observer2=_interopRequireDefault(_Observer);var _SetDateTime=require('./SetDateTime');var _SetDateTime2=_interopRequireDefault(_SetDateTime);var _reactNativeOpenMaps=require('react-native-open-maps');var _reactNativeOpenMaps2=_interopRequireDefault(_reactNativeOpenMaps);var _Info=require('../components/Info');var _Info2=_interopRequireDefault(_Info);var _TeamDetailsWithModel=require('./TeamDetailsWithModel');var _TeamDetailsWithModel2=_interopRequireDefault(_TeamDetailsWithModel);var _CheckBox=require('./CheckBox');var _CheckBox2=_interopRequireDefault(_CheckBox);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _=require('lodash');var Room=function(_Component){_inherits(Room,_Component);function Room(){var _ref;var _temp,_this,_ret;_classCallCheck(this,Room);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=Room.__proto__||Object.getPrototypeOf(Room)).call.apply(_ref,[this].concat(args))),_this),_this.state={date:'',type:'',room:{}},_temp),_possibleConstructorReturn(_this,_ret);}_createClass(Room,[{key:'componentDidMount',value:function componentDidMount(){var navigation=this.props.navigation;var _ref2=navigation?navigation.state.params:this.props,room=_ref2.room;if(this.props.room){this.setState({type:'createdRoom'});this.setState({room:room});}else{this.setState({type:'joinedRoom'});}}},{key:'componentWillReceiveProps',value:function componentWillReceiveProps(nextProps){var type=this.state.type;var roomsReducer=nextProps.roomsReducer,socket=nextProps.socket,joinRoom=nextProps.joinRoom;if(type=='createdRoom'){this.setState({room:roomsReducer.createdRoom});}else if(type=='joinedRoom'){this.setState({room:roomsReducer.joinedRoom});}}},{key:'componentWillUnmount',value:function componentWillUnmount(){var _props=this.props,leaveRoom=_props.leaveRoom,socket=_props.socket;var _state=this.state,room=_state.room,type=_state.type;if(type=='joinedRoom')leaveRoom(room,socket);}},{key:'render',value:function render(){var _state2=this.state,date=_state2.date,room=_state2.room,type=_state2.type;var _props2=this.props,style=_props2.style,showObserverModel=_props2.showObserverModel,socket=_props2.socket,setRoomDate=_props2.setRoomDate,setRoomLocation=_props2.setRoomLocation,roomsReducer=_props2.roomsReducer,stackNavigation=_props2.stackNavigation,setOpenedTeamDetails=_props2.setOpenedTeamDetails,showTeamDetailsModel=_props2.showTeamDetailsModel,showTeamDetails=_props2.showTeamDetails;var navigate=void 0;if(type=='createdRoom')navigate=stackNavigation.navigate;var location=room.settings&&_.has(room.settings,'location')?room.settings.location:null;return _react2.default.createElement(_reactNative.View,{style:{height:100+'%'},__source:{fileName:_jsxFileName,lineNumber:79}},showTeamDetails&&_react2.default.createElement(_TeamDetailsWithModel2.default,{__source:{fileName:_jsxFileName,lineNumber:81}}),_react2.default.createElement(_reactNative.View,{style:{alignSelf:'center',width:50+'%',height:40+'%',flexDirection:'row',justifyContent:'center',justifyContent:'space-between',alignItems:'baseline',backgroundColor:'green'},__source:{fileName:_jsxFileName,lineNumber:83}},_react2.default.createElement(_reactNative.View,{style:{backgroundColor:'yellow'},__source:{fileName:_jsxFileName,lineNumber:95}},_react2.default.createElement(_Info2.default,{userImgStyle:{width:40,height:40},name:room.teamOwner&&room.teamOwner.name,__source:{fileName:_jsxFileName,lineNumber:96}}),type!='createdRoom'&&_react2.default.createElement(Btn,{txtStyle:{fontStyle:'bold',fontSize:6,color:'white'},containerStyle:{padding:3,width:'auto',height:13,backgroundColor:'#1da1f2',alignItems:'center'},txt:'Team Details',onPress:function onPress(){setOpenedTeamDetails(room.teamOwner?room.teamOwner.records:null);showTeamDetailsModel();},__source:{fileName:_jsxFileName,lineNumber:101}}),_react2.default.createElement(_CheckBox2.default,{txt:'ready',__source:{fileName:_jsxFileName,lineNumber:117}})),_react2.default.createElement(_reactNative.View,{style:{height:400,backgroundColor:'yellow'},__source:{fileName:_jsxFileName,lineNumber:119}},_react2.default.createElement(_Info2.default,{userImgStyle:{width:40,height:40},name:room.joinedTeam&&room.joinedTeam.name,__source:{fileName:_jsxFileName,lineNumber:120}}),type!='joinedRoom'&&_react2.default.createElement(Btn,{txtStyle:{fontStyle:'bold',fontSize:6,color:'white'},containerStyle:{padding:3,width:'auto',height:13,backgroundColor:'#1da1f2',alignItems:'center'},txt:'Team Details',onPress:function onPress(){setOpenedTeamDetails(room.joinedTeam?room.joinedTeam.records:null);showTeamDetailsModel();},__source:{fileName:_jsxFileName,lineNumber:125}}),_react2.default.createElement(_CheckBox2.default,{txt:'ready',__source:{fileName:_jsxFileName,lineNumber:141}}))),_react2.default.createElement(_reactNative.View,{style:{backgroundColor:'#edf1f7',flex:1,alignItems:'center'},__source:{fileName:_jsxFileName,lineNumber:144}},_react2.default.createElement(_reactNative.View,{style:styles.settingsContainer,__source:{fileName:_jsxFileName,lineNumber:152}},_react2.default.createElement(_Observer2.default,{onAdd:function onAdd(){return showObserverModel();},observer:_.has(room,'settings')&&_.has(room.settings,'observer')&&Object.keys(room.settings.observer).length>0?room.settings.observer:null,roomOwner:room.id===roomsReducer.createdRoom.id,__source:{fileName:_jsxFileName,lineNumber:153}}),_react2.default.createElement(_SetDateTime2.default,{date:_.has(room,'settings')&&_.has(room.settings,'date')?room.settings.date:'',setDate:function setDate(date){return setRoomDate(room,date,socket);},__source:{fileName:_jsxFileName,lineNumber:164}}),_react2.default.createElement(_reactNative.View,{style:{flexDirection:'row',alignItems:'center',justifyContent:'space-between'},__source:{fileName:_jsxFileName,lineNumber:171}},_react2.default.createElement(_reactNative.View,{style:{width:50+'%',alignItems:'center'},__source:{fileName:_jsxFileName,lineNumber:178}},_react2.default.createElement(_reactNative.Text,{style:{fontSize:8,fontStyle:'bold'},__source:{fileName:_jsxFileName,lineNumber:184}},'Location:')),_react2.default.createElement(_reactNative.View,{style:{width:50+'%',alignItems:'center',justifyContent:'center'},__source:{fileName:_jsxFileName,lineNumber:187}},location&&location.address&&_react2.default.createElement(_reactNative.View,{style:{alignItems:'center',width:100+'%',flexDirection:'row',justifyContent:'center'},__source:{fileName:_jsxFileName,lineNumber:196}},_react2.default.createElement(_reactNative.Text,{style:{fontSize:6},__source:{fileName:_jsxFileName,lineNumber:204}},location&&location.address)),_react2.default.createElement(_reactNative.View,{__source:{fileName:_jsxFileName,lineNumber:207}},type=='createdRoom'&&_react2.default.createElement(Btn,{txtStyle:{fontStyle:'bold',fontSize:6,color:'white'},containerStyle:{padding:3,width:'auto',height:13,backgroundColor:'#1da1f2'},txt:''+(location&&location.address?'Change Location':'Set Location'),onPress:function onPress(){return navigate('SetLocation',{SetLocation:function SetLocation(locationCoordinates){return setRoomLocation(room,locationCoordinates,socket);}});},__source:{fileName:_jsxFileName,lineNumber:209}})||_react2.default.createElement(Btn,{txtStyle:{fontStyle:'bold',fontSize:6,color:'white'},containerStyle:{padding:3,height:13,backgroundColor:'#1da1f2'},txt:'Click To Open Maps',onPress:function onPress(){return(0,_reactNativeOpenMaps2.default)({latitude:location&&location.latitude,longitude:location&&location.longitude});},__source:{fileName:_jsxFileName,lineNumber:226}})))))));}}]);return Room;}(_react.Component);var styles=_reactNative.StyleSheet.create({settingsContainer:{marginTop:5,flexDirection:'column',width:70+'%',flex:1,padding:20}});var mapStateToProps=function mapStateToProps(_ref3){var auth=_ref3.auth,socket=_ref3.socket,roomsReducer=_ref3.roomsReducer,teamsReducer=_ref3.teamsReducer,model=_ref3.model;return{team:teamsReducer.curntTeam,socket:socket,roomsReducer:roomsReducer,showTeamDetails:model.showTeamDetails};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{showObserverModel:function showObserverModel(){dispatch((0,_actions.showObserverModel)());},setOpenedTeamDetails:function setOpenedTeamDetails(teamRecords){dispatch((0,_actions.setOpenedTeamDetails)(teamRecords));},showTeamDetailsModel:function showTeamDetailsModel(){dispatch((0,_actions.showTeamDetailsModel)());},setRoomDate:function setRoomDate(room,date,socket){dispatch((0,_actions.setRoomDate)(room,date,socket));},setRoomLocation:function setRoomLocation(room,location,socket){dispatch((0,_actions.setRoomLocation)(room,location,socket));},leaveRoom:function leaveRoom(room,socket){dispatch((0,_actions.leaveRoom)(room,socket));}};};exports.default=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(Room);