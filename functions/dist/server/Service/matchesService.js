Object.defineProperty(exports,"__esModule",{value:true});exports.matchesService=undefined;var _firebase=require('../config/firebase');var _firebase2=_interopRequireDefault(_firebase);var _Service=require('../Service');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var _=require('lodash');var matchesService=exports.matchesService={getMatchById:getMatchById,addMatch:addMatch};function addMatch(match){var matchRef=_firebase2.default.database().ref('Matches').push();return matchRef.set(match).then(function(){return Promise.resolve(matchRef.key);});}function getMatchById(matchId,teamId){var _this=this;var observerMood=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return new Promise(function(resolve,reject){_firebase2.default.database().ref('Matches'+'/'+matchId).once('value',function _callee2(snapshot){var match,matchObj,p1,p2;return regeneratorRuntime.async(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:match=snapshot.toJSON();matchObj={};matchObj.date=match.date;matchObj.location=match.location;p1=_Service.teamsService.getTeamById(match.awayTeam,'withoutTeamMatches');p2=_Service.teamsService.getTeamById(match.homeTeam,'withoutTeamMatches');_context2.next=8;return regeneratorRuntime.awrap(Promise.all([p1,p2]).then(function _callee(teams){var awayTeam,homeTeam;return regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:awayTeam=teams[0];homeTeam=teams[1];if(!observerMood){_context.next=7;break;}matchObj.firstTeam=homeTeam;matchObj.secondTeam=awayTeam;_context.next=11;break;case 7:if(teamId==match.homeTeam){matchObj.oponnentTeam=awayTeam;}else matchObj.oponnentTeam=homeTeam;_context.next=10;return regeneratorRuntime.awrap(_Service.usersService.getUserById(match.observer));case 10:matchObj.observer=_context.sent;case 11:return _context.abrupt('return',resolve(matchObj));case 12:case'end':return _context.stop();}}},null,_this);}));case 8:case'end':return _context2.stop();}}},null,_this);});});}